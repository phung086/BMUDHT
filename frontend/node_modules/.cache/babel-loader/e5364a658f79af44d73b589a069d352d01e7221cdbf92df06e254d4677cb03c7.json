{"ast":null,"code":"import _objectSpread from\"D:/BMUDHT/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useEffect,useMemo,useState}from\"react\";import{useNavigate}from\"react-router-dom\";import api from\"../services/api\";import Spinner from\"./Spinner\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const emailPattern=/^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;const UserProfile=()=>{const[user,setUser]=useState(null);const[loading,setLoading]=useState(true);const[error,setError]=useState(null);const[username,setUsername]=useState(\"\");const[email,setEmail]=useState(\"\");const[flash,setFlash]=useState(null);const[pwCurrent,setPwCurrent]=useState(\"\");const[pwNew,setPwNew]=useState(\"\");const[mfaEnabled,setMfaEnabled]=useState(false);const[mfaQR,setMfaQR]=useState(null);const[mfaSecret,setMfaSecret]=useState(\"\");const[mfaToken,setMfaToken]=useState(\"\");const[savingProfile,setSavingProfile]=useState(false);const[changingPw,setChangingPw]=useState(false);const[togglingMfa,setTogglingMfa]=useState(false);const[setupLoading,setSetupLoading]=useState(false);const[verifyingMfa,setVerifyingMfa]=useState(false);const navigate=useNavigate();useEffect(()=>{let mounted=true;(async()=>{try{var _res$data;const res=await api.get(\"/api/auth/me\");if(!mounted)return;const u=(_res$data=res.data)===null||_res$data===void 0?void 0:_res$data.user;if(!u){setError(\"Không tìm thấy hồ sơ người dùng\");return;}setUser(u);setUsername(u.username||\"\");setEmail(u.email||\"\");setMfaEnabled(Boolean(u.mfaEnabled));}catch(err){var _err$response;const status=(_err$response=err.response)===null||_err$response===void 0?void 0:_err$response.status;if(status===401||status===403){setError(\"Phiên đăng nhập đã hết hạn. Vui lòng đăng nhập lại.\");navigate(\"/login\",{replace:true});}else{var _err$response2,_err$response2$data;setError(((_err$response2=err.response)===null||_err$response2===void 0?void 0:(_err$response2$data=_err$response2.data)===null||_err$response2$data===void 0?void 0:_err$response2$data.error)||\"Không thể lấy thông tin người dùng\");}}finally{if(mounted)setLoading(false);}})();return()=>{mounted=false;};},[navigate]);useEffect(()=>{if(!flash)return;const timer=setTimeout(()=>setFlash(null),4500);return()=>clearTimeout(timer);},[flash]);const showFlash=function(text){let tone=arguments.length>1&&arguments[1]!==undefined?arguments[1]:\"info\";return setFlash({text,tone});};const initials=useMemo(()=>{if(!user)return\"U\";const source=user.username||user.email||\"User\";return source.trim().charAt(0).toUpperCase();},[user]);const saveProfile=async()=>{if(!username.trim()){showFlash(\"Tên người dùng không được bỏ trống.\",\"danger\");return;}if(!emailPattern.test(email.trim())){showFlash(\"Email không hợp lệ.\",\"danger\");return;}setSavingProfile(true);try{var _res$data2;const res=await api.put(\"/api/auth/me\",{username:username.trim(),email:email.trim()});setUser(prev=>_objectSpread(_objectSpread({},prev),{},{username:username.trim(),email:email.trim()}));showFlash(((_res$data2=res.data)===null||_res$data2===void 0?void 0:_res$data2.message)||\"Đã lưu thay đổi.\",\"success\");}catch(err){var _err$response3,_err$response3$data;showFlash(((_err$response3=err.response)===null||_err$response3===void 0?void 0:(_err$response3$data=_err$response3.data)===null||_err$response3$data===void 0?void 0:_err$response3$data.error)||\"Cập nhật thất bại.\",\"danger\");}finally{setSavingProfile(false);}};const changePassword=async()=>{if(!pwCurrent||!pwNew){showFlash(\"Vui lòng nhập đầy đủ mật khẩu hiện tại và mật khẩu mới.\",\"danger\");return;}if(pwNew.length<8){showFlash(\"Mật khẩu mới phải có ít nhất 8 ký tự.\",\"danger\");return;}setChangingPw(true);try{var _res$data3;const res=await api.post(\"/api/auth/change-password\",{currentPassword:pwCurrent,newPassword:pwNew});showFlash(((_res$data3=res.data)===null||_res$data3===void 0?void 0:_res$data3.message)||\"Đã đổi mật khẩu.\",\"success\");setPwCurrent(\"\");setPwNew(\"\");}catch(err){var _err$response4,_err$response4$data;showFlash(((_err$response4=err.response)===null||_err$response4===void 0?void 0:(_err$response4$data=_err$response4.data)===null||_err$response4$data===void 0?void 0:_err$response4$data.error)||\"Thay đổi mật khẩu thất bại.\",\"danger\");}finally{setChangingPw(false);}};const toggleMfa=async()=>{setTogglingMfa(true);try{var _res$data4,_res$data5;const res=await api.post(\"/api/auth/mfa/toggle\",{});setMfaEnabled(Boolean((_res$data4=res.data)===null||_res$data4===void 0?void 0:_res$data4.mfaEnabled));setMfaQR(null);setMfaSecret(\"\");setMfaToken(\"\");showFlash((_res$data5=res.data)!==null&&_res$data5!==void 0&&_res$data5.mfaEnabled?\"Đã bật MFA qua email OTP.\":\"Đã tắt MFA.\",\"success\");}catch(err){var _err$response5,_err$response5$data;showFlash(((_err$response5=err.response)===null||_err$response5===void 0?void 0:(_err$response5$data=_err$response5.data)===null||_err$response5$data===void 0?void 0:_err$response5$data.error)||\"Không thể thay đổi MFA.\",\"danger\");}finally{setTogglingMfa(false);}};const setupMfa=async()=>{setSetupLoading(true);try{var _res$data6,_res$data7;const res=await api.post(\"/api/auth/mfa/setup\",{});setMfaQR(((_res$data6=res.data)===null||_res$data6===void 0?void 0:_res$data6.qr)||null);setMfaSecret(((_res$data7=res.data)===null||_res$data7===void 0?void 0:_res$data7.secret)||\"\");showFlash(\"Đã tạo QR / secret. Vui lòng quét và xác thực.\",\"info\");}catch(err){var _err$response6,_err$response6$data;showFlash(((_err$response6=err.response)===null||_err$response6===void 0?void 0:(_err$response6$data=_err$response6.data)===null||_err$response6$data===void 0?void 0:_err$response6$data.error)||\"Không thể khởi tạo MFA.\",\"danger\");}finally{setSetupLoading(false);}};const verifyMfa=async()=>{if(mfaToken.trim().length<6){showFlash(\"Nhập mã 6 số từ ứng dụng trước khi xác nhận.\",\"danger\");return;}setVerifyingMfa(true);try{var _res$data8;const res=await api.post(\"/api/auth/mfa/verify\",{token:mfaToken.trim()});showFlash(((_res$data8=res.data)===null||_res$data8===void 0?void 0:_res$data8.message)||\"Đã bật MFA.\",\"success\");setMfaEnabled(true);setMfaQR(null);setMfaSecret(\"\");setMfaToken(\"\");}catch(err){var _err$response7,_err$response7$data;showFlash(((_err$response7=err.response)===null||_err$response7===void 0?void 0:(_err$response7$data=_err$response7.data)===null||_err$response7$data===void 0?void 0:_err$response7$data.error)||\"Mã xác nhận không đúng.\",\"danger\");}finally{setVerifyingMfa(false);}};if(loading){return/*#__PURE__*/_jsxs(\"div\",{className:\"card p-4 text-center profile-loading\",children:[/*#__PURE__*/_jsx(Spinner,{size:28}),/*#__PURE__*/_jsx(\"span\",{children:\"\\u0110ang t\\u1EA3i h\\u1ED3 s\\u01A1...\"})]});}if(error){return/*#__PURE__*/_jsxs(\"div\",{className:\"card p-4 profile-error text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"alert alert-danger mb-3\",children:error}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-primary\",onClick:()=>navigate(\"/login\"),children:\"Quay l\\u1EA1i \\u0111\\u0103ng nh\\u1EADp\"})]});}if(!user){return/*#__PURE__*/_jsx(\"div\",{className:\"card p-4 text-center\",children:/*#__PURE__*/_jsx(\"div\",{className:\"alert alert-warning mb-0\",children:\"Kh\\xF4ng t\\xECm th\\u1EA5y d\\u1EEF li\\u1EC7u ng\\u01B0\\u1EDDi d\\xF9ng.\"})});}const balanceDisplay=typeof user.balance===\"number\"?user.balance.toLocaleString(\"vi-VN\"):Number(user.balance||0).toLocaleString(\"vi-VN\");return/*#__PURE__*/_jsxs(\"div\",{className:\"profile-page\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"profile-hero card mb-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"profile-avatar\",children:initials}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{className:\"profile-title mb-1\",children:user.username||\"Người dùng\"}),/*#__PURE__*/_jsx(\"div\",{className:\"profile-meta\",children:user.email}),/*#__PURE__*/_jsxs(\"div\",{className:\"profile-meta mt-2\",children:[\"Vai tr\\xF2: \",/*#__PURE__*/_jsx(\"strong\",{children:user.role||\"user\"}),\" \\xB7 S\\u1ED1 d\\u01B0:\",/*#__PURE__*/_jsxs(\"strong\",{children:[\" \",balanceDisplay,\" VND\"]})]})]})]}),flash&&/*#__PURE__*/_jsx(\"div\",{className:\"alert alert-\".concat(flash.tone,\" shadow-sm profile-alert\"),children:flash.text}),/*#__PURE__*/_jsxs(\"div\",{className:\"row g-4 profile-grid\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"col-lg-6\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"card h-100 p-4\",children:[/*#__PURE__*/_jsx(\"h5\",{className:\"section-title\",children:\"Th\\xF4ng tin c\\xE1 nh\\xE2n\"}),/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"T\\xEAn ng\\u01B0\\u1EDDi d\\xF9ng\"}),/*#__PURE__*/_jsx(\"input\",{className:\"form-control mb-3\",value:username,onChange:e=>setUsername(e.target.value),placeholder:\"Nh\\u1EADp t\\xEAn hi\\u1EC3n th\\u1ECB\"}),/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"Email\"}),/*#__PURE__*/_jsx(\"input\",{className:\"form-control mb-4\",value:email,onChange:e=>setEmail(e.target.value),placeholder:\"name@example.com\"}),/*#__PURE__*/_jsxs(\"button\",{className:\"btn btn-primary\",onClick:saveProfile,disabled:savingProfile,children:[savingProfile&&/*#__PURE__*/_jsx(Spinner,{size:18}),\"L\\u01B0u thay \\u0111\\u1ED5i\"]})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"col-lg-6\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"card h-100 p-4\",children:[/*#__PURE__*/_jsx(\"h5\",{className:\"section-title\",children:\"\\u0110\\u1ED5i m\\u1EADt kh\\u1EA9u\"}),/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"M\\u1EADt kh\\u1EA9u hi\\u1EC7n t\\u1EA1i\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",className:\"form-control mb-3\",value:pwCurrent,onChange:e=>setPwCurrent(e.target.value),placeholder:\"Nh\\u1EADp m\\u1EADt kh\\u1EA9u hi\\u1EC7n t\\u1EA1i\"}),/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"M\\u1EADt kh\\u1EA9u m\\u1EDBi\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",className:\"form-control mb-4\",value:pwNew,onChange:e=>setPwNew(e.target.value),placeholder:\"\\xCDt nh\\u1EA5t 8 k\\xFD t\\u1EF1\"}),/*#__PURE__*/_jsxs(\"button\",{className:\"btn btn-warning text-white\",onClick:changePassword,disabled:changingPw,children:[changingPw&&/*#__PURE__*/_jsx(Spinner,{size:18}),\"\\u0110\\u1ED5i m\\u1EADt kh\\u1EA9u\"]})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"col-12\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"card p-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-between align-items-start flex-wrap gap-3\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h5\",{className:\"section-title mb-1\",children:\"B\\u1EA3o m\\u1EADt 2 l\\u1EDBp (MFA)\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"profile-meta\",children:[\"Tr\\u1EA1ng th\\xE1i:\\xA0\",mfaEnabled?/*#__PURE__*/_jsx(\"span\",{className:\"badge bg-success\",children:\"\\u0110ang b\\u1EADt\"}):/*#__PURE__*/_jsx(\"span\",{className:\"badge bg-secondary\",children:\"\\u0110ang t\\u1EAFt\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex gap-2\",children:[/*#__PURE__*/_jsxs(\"button\",{className:\"btn btn-outline-secondary\",onClick:toggleMfa,disabled:togglingMfa,children:[togglingMfa&&/*#__PURE__*/_jsx(Spinner,{size:18}),mfaEnabled?\"Tắt MFA\":\"Bật nhanh (Email OTP)\"]}),/*#__PURE__*/_jsxs(\"button\",{className:\"btn btn-outline-primary\",onClick:setupMfa,disabled:setupLoading,children:[setupLoading&&/*#__PURE__*/_jsx(Spinner,{size:18}),\"Thi\\u1EBFt l\\u1EADp b\\u1EB1ng \\u1EE9ng d\\u1EE5ng\"]})]})]}),mfaQR&&/*#__PURE__*/_jsxs(\"div\",{className:\"mfa-setup mt-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"mfa-instructions\",children:\"Qu\\xE9t QR b\\u1EB1ng Google Authenticator ho\\u1EB7c nh\\u1EADp secret b\\xEAn d\\u01B0\\u1EDBi.\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"mfa-qr-wrapper\",children:[/*#__PURE__*/_jsx(\"img\",{src:mfaQR,alt:\"MFA QR\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"mfa-secret\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Secret:\"}),/*#__PURE__*/_jsx(\"code\",{children:mfaSecret})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-3\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"Nh\\u1EADp m\\xE3 6 s\\u1ED1\"}),/*#__PURE__*/_jsx(\"input\",{className:\"form-control\",value:mfaToken,onChange:e=>setMfaToken(e.target.value),placeholder:\"123456\"}),/*#__PURE__*/_jsxs(\"button\",{className:\"btn btn-success mt-3\",onClick:verifyMfa,disabled:verifyingMfa,children:[verifyingMfa&&/*#__PURE__*/_jsx(Spinner,{size:18}),\"X\\xE1c nh\\u1EADn k\\xEDch ho\\u1EA1t\"]})]})]})]})})]})]});};export default UserProfile;","map":{"version":3,"names":["React","useEffect","useMemo","useState","useNavigate","api","Spinner","jsx","_jsx","jsxs","_jsxs","emailPattern","UserProfile","user","setUser","loading","setLoading","error","setError","username","setUsername","email","setEmail","flash","setFlash","pwCurrent","setPwCurrent","pwNew","setPwNew","mfaEnabled","setMfaEnabled","mfaQR","setMfaQR","mfaSecret","setMfaSecret","mfaToken","setMfaToken","savingProfile","setSavingProfile","changingPw","setChangingPw","togglingMfa","setTogglingMfa","setupLoading","setSetupLoading","verifyingMfa","setVerifyingMfa","navigate","mounted","_res$data","res","get","u","data","Boolean","err","_err$response","status","response","replace","_err$response2","_err$response2$data","timer","setTimeout","clearTimeout","showFlash","text","tone","arguments","length","undefined","initials","source","trim","charAt","toUpperCase","saveProfile","test","_res$data2","put","prev","_objectSpread","message","_err$response3","_err$response3$data","changePassword","_res$data3","post","currentPassword","newPassword","_err$response4","_err$response4$data","toggleMfa","_res$data4","_res$data5","_err$response5","_err$response5$data","setupMfa","_res$data6","_res$data7","qr","secret","_err$response6","_err$response6$data","verifyMfa","_res$data8","token","_err$response7","_err$response7$data","className","children","size","onClick","balanceDisplay","balance","toLocaleString","Number","role","concat","value","onChange","e","target","placeholder","disabled","type","src","alt"],"sources":["D:/BMUDHT/frontend/src/components/UserProfile.js"],"sourcesContent":["import React, { useEffect, useMemo, useState } from \"react\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport api from \"../services/api\";\r\nimport Spinner from \"./Spinner\";\r\n\r\nconst emailPattern = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\r\n\r\nconst UserProfile = () => {\r\n  const [user, setUser] = useState(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState(null);\r\n  const [username, setUsername] = useState(\"\");\r\n  const [email, setEmail] = useState(\"\");\r\n  const [flash, setFlash] = useState(null);\r\n  const [pwCurrent, setPwCurrent] = useState(\"\");\r\n  const [pwNew, setPwNew] = useState(\"\");\r\n  const [mfaEnabled, setMfaEnabled] = useState(false);\r\n  const [mfaQR, setMfaQR] = useState(null);\r\n  const [mfaSecret, setMfaSecret] = useState(\"\");\r\n  const [mfaToken, setMfaToken] = useState(\"\");\r\n  const [savingProfile, setSavingProfile] = useState(false);\r\n  const [changingPw, setChangingPw] = useState(false);\r\n  const [togglingMfa, setTogglingMfa] = useState(false);\r\n  const [setupLoading, setSetupLoading] = useState(false);\r\n  const [verifyingMfa, setVerifyingMfa] = useState(false);\r\n\r\n  const navigate = useNavigate();\r\n\r\n  useEffect(() => {\r\n    let mounted = true;\r\n    (async () => {\r\n      try {\r\n        const res = await api.get(\"/api/auth/me\");\r\n        if (!mounted) return;\r\n        const u = res.data?.user;\r\n        if (!u) {\r\n          setError(\"Không tìm thấy hồ sơ người dùng\");\r\n          return;\r\n        }\r\n        setUser(u);\r\n        setUsername(u.username || \"\");\r\n        setEmail(u.email || \"\");\r\n        setMfaEnabled(Boolean(u.mfaEnabled));\r\n      } catch (err) {\r\n        const status = err.response?.status;\r\n        if (status === 401 || status === 403) {\r\n          setError(\"Phiên đăng nhập đã hết hạn. Vui lòng đăng nhập lại.\");\r\n          navigate(\"/login\", { replace: true });\r\n        } else {\r\n          setError(\r\n            err.response?.data?.error || \"Không thể lấy thông tin người dùng\"\r\n          );\r\n        }\r\n      } finally {\r\n        if (mounted) setLoading(false);\r\n      }\r\n    })();\r\n    return () => {\r\n      mounted = false;\r\n    };\r\n  }, [navigate]);\r\n\r\n  useEffect(() => {\r\n    if (!flash) return;\r\n    const timer = setTimeout(() => setFlash(null), 4500);\r\n    return () => clearTimeout(timer);\r\n  }, [flash]);\r\n\r\n  const showFlash = (text, tone = \"info\") => setFlash({ text, tone });\r\n\r\n  const initials = useMemo(() => {\r\n    if (!user) return \"U\";\r\n    const source = user.username || user.email || \"User\";\r\n    return source.trim().charAt(0).toUpperCase();\r\n  }, [user]);\r\n\r\n  const saveProfile = async () => {\r\n    if (!username.trim()) {\r\n      showFlash(\"Tên người dùng không được bỏ trống.\", \"danger\");\r\n      return;\r\n    }\r\n    if (!emailPattern.test(email.trim())) {\r\n      showFlash(\"Email không hợp lệ.\", \"danger\");\r\n      return;\r\n    }\r\n    setSavingProfile(true);\r\n    try {\r\n      const res = await api.put(\"/api/auth/me\", {\r\n        username: username.trim(),\r\n        email: email.trim(),\r\n      });\r\n      setUser((prev) => ({\r\n        ...prev,\r\n        username: username.trim(),\r\n        email: email.trim(),\r\n      }));\r\n      showFlash(res.data?.message || \"Đã lưu thay đổi.\", \"success\");\r\n    } catch (err) {\r\n      showFlash(err.response?.data?.error || \"Cập nhật thất bại.\", \"danger\");\r\n    } finally {\r\n      setSavingProfile(false);\r\n    }\r\n  };\r\n\r\n  const changePassword = async () => {\r\n    if (!pwCurrent || !pwNew) {\r\n      showFlash(\r\n        \"Vui lòng nhập đầy đủ mật khẩu hiện tại và mật khẩu mới.\",\r\n        \"danger\"\r\n      );\r\n      return;\r\n    }\r\n    if (pwNew.length < 8) {\r\n      showFlash(\"Mật khẩu mới phải có ít nhất 8 ký tự.\", \"danger\");\r\n      return;\r\n    }\r\n    setChangingPw(true);\r\n    try {\r\n      const res = await api.post(\"/api/auth/change-password\", {\r\n        currentPassword: pwCurrent,\r\n        newPassword: pwNew,\r\n      });\r\n      showFlash(res.data?.message || \"Đã đổi mật khẩu.\", \"success\");\r\n      setPwCurrent(\"\");\r\n      setPwNew(\"\");\r\n    } catch (err) {\r\n      showFlash(\r\n        err.response?.data?.error || \"Thay đổi mật khẩu thất bại.\",\r\n        \"danger\"\r\n      );\r\n    } finally {\r\n      setChangingPw(false);\r\n    }\r\n  };\r\n\r\n  const toggleMfa = async () => {\r\n    setTogglingMfa(true);\r\n    try {\r\n      const res = await api.post(\"/api/auth/mfa/toggle\", {});\r\n      setMfaEnabled(Boolean(res.data?.mfaEnabled));\r\n      setMfaQR(null);\r\n      setMfaSecret(\"\");\r\n      setMfaToken(\"\");\r\n      showFlash(\r\n        res.data?.mfaEnabled ? \"Đã bật MFA qua email OTP.\" : \"Đã tắt MFA.\",\r\n        \"success\"\r\n      );\r\n    } catch (err) {\r\n      showFlash(\r\n        err.response?.data?.error || \"Không thể thay đổi MFA.\",\r\n        \"danger\"\r\n      );\r\n    } finally {\r\n      setTogglingMfa(false);\r\n    }\r\n  };\r\n\r\n  const setupMfa = async () => {\r\n    setSetupLoading(true);\r\n    try {\r\n      const res = await api.post(\"/api/auth/mfa/setup\", {});\r\n      setMfaQR(res.data?.qr || null);\r\n      setMfaSecret(res.data?.secret || \"\");\r\n      showFlash(\"Đã tạo QR / secret. Vui lòng quét và xác thực.\", \"info\");\r\n    } catch (err) {\r\n      showFlash(\r\n        err.response?.data?.error || \"Không thể khởi tạo MFA.\",\r\n        \"danger\"\r\n      );\r\n    } finally {\r\n      setSetupLoading(false);\r\n    }\r\n  };\r\n\r\n  const verifyMfa = async () => {\r\n    if (mfaToken.trim().length < 6) {\r\n      showFlash(\"Nhập mã 6 số từ ứng dụng trước khi xác nhận.\", \"danger\");\r\n      return;\r\n    }\r\n    setVerifyingMfa(true);\r\n    try {\r\n      const res = await api.post(\"/api/auth/mfa/verify\", {\r\n        token: mfaToken.trim(),\r\n      });\r\n      showFlash(res.data?.message || \"Đã bật MFA.\", \"success\");\r\n      setMfaEnabled(true);\r\n      setMfaQR(null);\r\n      setMfaSecret(\"\");\r\n      setMfaToken(\"\");\r\n    } catch (err) {\r\n      showFlash(\r\n        err.response?.data?.error || \"Mã xác nhận không đúng.\",\r\n        \"danger\"\r\n      );\r\n    } finally {\r\n      setVerifyingMfa(false);\r\n    }\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"card p-4 text-center profile-loading\">\r\n        <Spinner size={28} />\r\n        <span>Đang tải hồ sơ...</span>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (error) {\r\n    return (\r\n      <div className=\"card p-4 profile-error text-center\">\r\n        <div className=\"alert alert-danger mb-3\">{error}</div>\r\n        <button className=\"btn btn-primary\" onClick={() => navigate(\"/login\")}>\r\n          Quay lại đăng nhập\r\n        </button>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (!user) {\r\n    return (\r\n      <div className=\"card p-4 text-center\">\r\n        <div className=\"alert alert-warning mb-0\">\r\n          Không tìm thấy dữ liệu người dùng.\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  const balanceDisplay =\r\n    typeof user.balance === \"number\"\r\n      ? user.balance.toLocaleString(\"vi-VN\")\r\n      : Number(user.balance || 0).toLocaleString(\"vi-VN\");\r\n\r\n  return (\r\n    <div className=\"profile-page\">\r\n      <div className=\"profile-hero card mb-4\">\r\n        <div className=\"profile-avatar\">{initials}</div>\r\n        <div>\r\n          <h2 className=\"profile-title mb-1\">\r\n            {user.username || \"Người dùng\"}\r\n          </h2>\r\n          <div className=\"profile-meta\">{user.email}</div>\r\n          <div className=\"profile-meta mt-2\">\r\n            Vai trò: <strong>{user.role || \"user\"}</strong> · Số dư:\r\n            <strong> {balanceDisplay} VND</strong>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {flash && (\r\n        <div className={`alert alert-${flash.tone} shadow-sm profile-alert`}>\r\n          {flash.text}\r\n        </div>\r\n      )}\r\n\r\n      <div className=\"row g-4 profile-grid\">\r\n        <div className=\"col-lg-6\">\r\n          <div className=\"card h-100 p-4\">\r\n            <h5 className=\"section-title\">Thông tin cá nhân</h5>\r\n            <label className=\"form-label\">Tên người dùng</label>\r\n            <input\r\n              className=\"form-control mb-3\"\r\n              value={username}\r\n              onChange={(e) => setUsername(e.target.value)}\r\n              placeholder=\"Nhập tên hiển thị\"\r\n            />\r\n            <label className=\"form-label\">Email</label>\r\n            <input\r\n              className=\"form-control mb-4\"\r\n              value={email}\r\n              onChange={(e) => setEmail(e.target.value)}\r\n              placeholder=\"name@example.com\"\r\n            />\r\n            <button\r\n              className=\"btn btn-primary\"\r\n              onClick={saveProfile}\r\n              disabled={savingProfile}\r\n            >\r\n              {savingProfile && <Spinner size={18} />}Lưu thay đổi\r\n            </button>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"col-lg-6\">\r\n          <div className=\"card h-100 p-4\">\r\n            <h5 className=\"section-title\">Đổi mật khẩu</h5>\r\n            <label className=\"form-label\">Mật khẩu hiện tại</label>\r\n            <input\r\n              type=\"password\"\r\n              className=\"form-control mb-3\"\r\n              value={pwCurrent}\r\n              onChange={(e) => setPwCurrent(e.target.value)}\r\n              placeholder=\"Nhập mật khẩu hiện tại\"\r\n            />\r\n            <label className=\"form-label\">Mật khẩu mới</label>\r\n            <input\r\n              type=\"password\"\r\n              className=\"form-control mb-4\"\r\n              value={pwNew}\r\n              onChange={(e) => setPwNew(e.target.value)}\r\n              placeholder=\"Ít nhất 8 ký tự\"\r\n            />\r\n            <button\r\n              className=\"btn btn-warning text-white\"\r\n              onClick={changePassword}\r\n              disabled={changingPw}\r\n            >\r\n              {changingPw && <Spinner size={18} />}Đổi mật khẩu\r\n            </button>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"col-12\">\r\n          <div className=\"card p-4\">\r\n            <div className=\"d-flex justify-content-between align-items-start flex-wrap gap-3\">\r\n              <div>\r\n                <h5 className=\"section-title mb-1\">Bảo mật 2 lớp (MFA)</h5>\r\n                <div className=\"profile-meta\">\r\n                  Trạng thái:&nbsp;\r\n                  {mfaEnabled ? (\r\n                    <span className=\"badge bg-success\">Đang bật</span>\r\n                  ) : (\r\n                    <span className=\"badge bg-secondary\">Đang tắt</span>\r\n                  )}\r\n                </div>\r\n              </div>\r\n              <div className=\"d-flex gap-2\">\r\n                <button\r\n                  className=\"btn btn-outline-secondary\"\r\n                  onClick={toggleMfa}\r\n                  disabled={togglingMfa}\r\n                >\r\n                  {togglingMfa && <Spinner size={18} />}\r\n                  {mfaEnabled ? \"Tắt MFA\" : \"Bật nhanh (Email OTP)\"}\r\n                </button>\r\n                <button\r\n                  className=\"btn btn-outline-primary\"\r\n                  onClick={setupMfa}\r\n                  disabled={setupLoading}\r\n                >\r\n                  {setupLoading && <Spinner size={18} />}\r\n                  Thiết lập bằng ứng dụng\r\n                </button>\r\n              </div>\r\n            </div>\r\n\r\n            {mfaQR && (\r\n              <div className=\"mfa-setup mt-4\">\r\n                <div className=\"mfa-instructions\">\r\n                  Quét QR bằng Google Authenticator hoặc nhập secret bên dưới.\r\n                </div>\r\n                <div className=\"mfa-qr-wrapper\">\r\n                  <img src={mfaQR} alt=\"MFA QR\" />\r\n                  <div className=\"mfa-secret\">\r\n                    <span>Secret:</span>\r\n                    <code>{mfaSecret}</code>\r\n                  </div>\r\n                </div>\r\n                <div className=\"mt-3\">\r\n                  <label className=\"form-label\">Nhập mã 6 số</label>\r\n                  <input\r\n                    className=\"form-control\"\r\n                    value={mfaToken}\r\n                    onChange={(e) => setMfaToken(e.target.value)}\r\n                    placeholder=\"123456\"\r\n                  />\r\n                  <button\r\n                    className=\"btn btn-success mt-3\"\r\n                    onClick={verifyMfa}\r\n                    disabled={verifyingMfa}\r\n                  >\r\n                    {verifyingMfa && <Spinner size={18} />}\r\n                    Xác nhận kích hoạt\r\n                  </button>\r\n                </div>\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default UserProfile;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}